<section id="container" class="container">
<p><button onclick="getStream()">Grab video</button></p>
<p><video autoplay style="height: 180px; width: 240px;"></video></p>
<p><button onclick="takePhoto()">Take Photo!</button></p>
<p><img id="imageTag" width="240" height="180"></p>
<div id="desc"></div>
<div id="yourElement" class="container" style="height: 180px; width: 240px;"></div>
<div id="result"></div>

</section>
<script src="/js/libs/quagga.js"></script>
<script type="text/javascript">
Quagga.init({
  inputStream : {
    name : "Live",
    type : "LiveStream",
    target: document.querySelector("#yourElement"),
    constraints: {
      width: { max: 200 },
      height: { max: 160 },
      aspectRatio: { min: 1, max: 100 },
      facingMode: "environment",
      deviceId: "6a579f45ce65cbf6f4d0a4b26550a9bcd72af3609da24b0ebf53e4c5b8201461"
    },
  },
  area: { // defines rectangle of the detection/localization area
	    top: "0%",    // top offset
	    right: "0%",  // right offset
	    left: "0%",   // left offset
	    bottom: "0%"  // bottom offset
	  },
  singleChannel: false, // true: only the red color-channel is read
  decoder : {
    readers : ["code_128_reader"]
  }
}, function(err) {
    if (err) {
        console.log(err);
        return
    }
    console.log("Initialization finished. Ready to start");
    Quagga.start();
});

if (navigator.mediaDevices && typeof navigator.mediaDevices.getUserMedia === 'function') {
	  // safely access `navigator.mediaDevices.getUserMedia`
	  console.log("acses");
	  navigator.mediaDevices.enumerateDevices()
	  .then(function(devices) {
	    devices.forEach(function(device) {
	      var desc = device.kind + ": " + device.label + " id = " + device.deviceId + "\n\n";
	  	var full_desc = document.getElementById("desc").innerHTML;
	  	
	  	document.getElementById("desc").innerHTML = full_desc + desc;
	      
	  	
	  	//var para = document.createElement("p");
	  	//var node = document.createTextNode("This is new.");
	  	//para.appendChild(node);
	  	console.log(desc);
	    });
	  })
	  .catch(function(err) {
	    console.log(err.name + ": " + err.message);
	  });
}
	
if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {
	  console.log("enumerateDevices() not supported.");
	}

// List cameras and microphones.

navigator.mediaDevices.enumerateDevices()
.then(function(devices) {
  devices.forEach(function(device) {
    var desc = device.kind + ": " + device.label + " id = " + device.deviceId + "\n\n";
	var full_desc = document.getElementById("desc").innerHTML;
	
	document.getElementById("desc").innerHTML = full_desc + desc;
    
	console.log(desc);
  });
})
.catch(function(err) {
  console.log(err.name + ": " + err.message);
});


Quagga.onDetected(onDetected);

function onDetected(result){
	console.log("result > " + result);
	document.getElementById("result").innerHTML = result;
}
</script>

